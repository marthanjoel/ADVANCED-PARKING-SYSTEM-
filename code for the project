// Joystick pins
int joyX = A0;
int joyY = A1;

// LED pins
int redLED = 9;
int greenLED = 10;
int yellowLED = 11;

// Buzzer pin
int buzzer = 3;

// KY-032 sensor pin
int ky032 = 2;  // Digital output

void setup() {
  pinMode(redLED, OUTPUT);
  pinMode(greenLED, OUTPUT);
  pinMode(yellowLED, OUTPUT);
  pinMode(buzzer, OUTPUT);
  pinMode(ky032, INPUT);
  Serial.begin(9600);
}

void loop() {
  int yVal = analogRead(joyY);
  int sensorState = digitalRead(ky032);

  Serial.print("Joystick Y: "); Serial.print(yVal);
  Serial.print(" | Sensor: "); Serial.println(sensorState);

  // Reset all LEDs and buzzer first
  digitalWrite(redLED, LOW);
  digitalWrite(yellowLED, LOW);
  digitalWrite(greenLED, LOW);
  digitalWrite(buzzer, LOW);

  // Check for "very close" condition
  if (sensorState == LOW || yVal < 400) {  // KY-032 detects obstacle OR joystick up
    digitalWrite(redLED, HIGH);
    digitalWrite(buzzer, HIGH);
    delay(2000);  // Keep Red LED + Buzzer ON for 2 seconds
  }
  else if (yVal > 400 && yVal <= 600) { // Joystick center → medium zone
    digitalWrite(yellowLED, HIGH);
  }
  else if (yVal > 600) { // Joystick down → safe/far zone
    digitalWrite(greenLED, HIGH);
  }

  delay(100); // Small delay for stability
}
